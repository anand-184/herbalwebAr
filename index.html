<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Herbal Garden AR</title>

    <!-- A-Frame and AR.js -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@1.7.2/aframe/build/aframe-ar.min.js"></script>

    <style>
        body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; }
        #controls {
            position: absolute; top: 10px; left: 10px; z-index: 10;
            display: flex; flex-direction: column; gap: 10px;
        }
        #plantSelector, #addModelButton {
            padding: 10px; font-size: 16px; background: white;
            border: 1px solid black; border-radius: 5px; cursor: pointer;
        }
    </style>
</head>
<body>

    <!-- Controls -->
    <div id="controls">
        <select id="plantSelector">
            <option value="models/Plant.glb">üåø Tulsi</option>
            <option value="models/Coffee_plant.glb">‚òï Coffee</option>
            <option value="models/rosemary.glb">üå± Aloe Vera</option>
            <option value="models/shelf_plants.glb">‚òòÔ∏è Shelf Plants</option>
            <option value="models/Flower_Pot.glb">ü™¥ Flower Pot</option>
        </select>
        <button id="addModelButton">‚ûï Add New Plant</button>
    </div>

    <!-- AR Scene -->
    <a-scene embedded arjs="sourceType: environment; debugUIEnabled: false;">
             
        <!-- AR Camera -->
        <a-camera gps-camera rotation-reader arjs-camera="facingMode: environment"></a-camera>

        <!-- Lighting -->
        <a-entity light="type: directional; intensity: 1.2" position="1 3 3"></a-entity>
        <a-entity light="type: ambient; intensity: 0.5"></a-entity>

        <!-- Main plant model  -->
        <a-entity id="plantModel"  position="0 0 -2" scale="1 1 1"
                  gltf-model="models/House_Plant.glb">
        </a-entity>

        <!-- Container for multiple plants -->
        <a-entity id="plantsContainer"></a-entity>

    </a-scene>

    <script>
        let plantSelector = document.getElementById("plantSelector");
        let addModelButton = document.getElementById("addModelButton");
        let plantsContainer = document.getElementById("plantsContainer");

        // Function to create a new plant model
        function createPlantModel(selectedPlant) {
            let newPlant = document.createElement("a-entity");

            let randomX = (Math.random() * 2 - 1).toFixed(2);
            let randomZ = (-2 + Math.random()).toFixed(2);

            newPlant.setAttribute("gltf-model", selectedPlant);
            newPlant.setAttribute("position", `${randomX} 0 ${randomZ}`);  
            newPlant.setAttribute("scale", "0.5 0.5 0.5");
            newPlant.setAttribute("rotation", "0 0 0");
            newPlant.setAttribute("class", "plant");

            // Add event listener for individual plant interactions
            newPlant.addEventListener("click", function (event) {
                if (event.button === 0) {
                    // Left click: Rotate 45 degrees
                    let currentRotation = newPlant.getAttribute("rotation");
                    newPlant.setAttribute("rotation", `0 ${currentRotation.y + 45} 0`);
                }
            });

            // Right-click to increase size, Shift + Right-click to decrease size
            newPlant.addEventListener("contextmenu", function (event) {
                event.preventDefault(); // Prevents default context menu

                let currentScale = newPlant.getAttribute("scale");
                let scaleFactor = event.shiftKey ? -0.1 : 0.1; // Shift key reduces size
                let newScale = Math.max(0.2, Math.min(1.5, currentScale.x + scaleFactor)); // Limits scaling

                newPlant.setAttribute("scale", `${newScale} ${newScale} ${newScale}`);
            });

            plantsContainer.appendChild(newPlant);
            console.log("Added new model:", selectedPlant);
        }

        // Add new plants dynamically
        addModelButton.addEventListener("click", function() {
            let selectedPlant = plantSelector.value;
            createPlantModel(selectedPlant);
        });
    </script>

</body>
</html>
